正方形的右上角坐标为(n, n)，那么整个正方形格点上的苹果数目是多少？

仅仅计算第一象限的，然后将第一象限的苹果数乘4，即为整个正方形的苹果数，考虑到不同象限在坐标轴上相交，因此计算第一象限时取左闭右开(计数第一象限左边界，不计数下边界)，这样最后直接乘4就是总数。

考虑直线簇$x + y = k$，格点$(x, y)$处的苹果数为$|x|+|y|$，则直线在第一象限内正方形内的每个格点上的苹果数都为k，$k = 1, 2, 3,... ,2n$，对单独的一条$x + y = k$，对于直线在第一象限内在正方形内，需满足的关系是:

$$ \left\{
\begin{aligned}
0 \leq x \leq n \\
0 < y \leq n \\
0 \leq x \leq k \\
0 < y \leq k
\end{aligned}
\right.
$$

(上面y不能取0而x可以是因为对第一象限计数左边界不计数下边界)

解出来x的范围是$[max(k - n, 0), min(k - 1, n)]$

* 当$1 \leq k \leq n$时，$x \in [0, k - 1]$，有k个格点

* 当$k = n + 1$时，$x \in [1, n]$，有n个格点

* 当$n + 2 \leq k \leq 2n$时，$x \in [k - n, n]$，有$2n - k + 1$个格点

于是，这些线段簇上的总苹果数为(这个计算过程很繁琐):

$\sum\limits_{k=1}^{n}k \cdot k + n(n+1) + \sum\limits_{k=n+2}^{2n}k(2n-k+1)$

$=\sum\limits_{k=1}^{n}k^2 + n(n+1) + \sum\limits_{k=n+2}^{2n}(2nk-k^2+k)$

$=\frac{n(n+1)(2n+1)}{6} + n^2 + n + (2n+1)\sum\limits_{k=n+2}^{2n}k - \sum\limits_{k=1}^{2n}k^2 + \sum\limits_{k=1}^{n+1}k^2$

$=\frac{n(n+1)(2n+1)}{3} + n^2 + n + (2n + 1) \cdot \frac {(3n+2)(n-1)}{2} - \frac {2n(2n+1)(4n+1)}{6} + (n+1)^2$

$=\frac{2n^3 + 3n^2 + n}{2}$

$=\frac{n(n+1)(2n+1)}{2}$